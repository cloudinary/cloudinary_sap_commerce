<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
 Copyright (c) 2020 SAP SE or an SAP affiliate company. All rights reserved
-->
<config xmlns="http://www.hybris.com/cockpit/config"
		xmlns:editorArea="http://www.hybris.com/cockpitng/component/editorArea"
		xmlns:list-view="http://www.hybris.com/cockpitng/component/listView"
		xmlns:wz="http://www.hybris.com/cockpitng/config/wizard-config"
		xmlns:hybris="http://www.hybris.com/cockpit/config/hybris"
		xmlns:ea="http://www.hybris.com/cockpitng/component/editorArea"
		xmlns:y="http://www.hybris.com/cockpit/config/hybris"
		xmlns:advanced-search="http://www.hybris.com/cockpitng/config/advancedsearch"
		xmlns:explorer-tree="http://www.hybris.com/cockpitng/config/explorertree">

	<!-- cloudinarymediabackoffice UI configuration should be provided here -->

	<context merge-by="type" parent="GenericItem" type="CloudinaryConfig" component="base">
		<y:base>
			<y:labels>
				<y:label>'Cloudinary'+' '+ 'Configuration'</y:label>
			</y:labels>
		</y:base>
	</context>

	<context type="Media" component="advanced-search" merge-by="type" parent="AbstractMedia">
		<advanced-search:advanced-search xmlns:advanced-search="http://www.hybris.com/cockpitng/config/advancedsearch">
			<advanced-search:field-list>
				<advanced-search:field name="cloudinaryUrl" selected="true" operator="contains"/>
			</advanced-search:field-list>
		</advanced-search:advanced-search>
	</context>

	<!--Explorer tree -->

	<context component="explorer-tree" module="cloudinarymediabackoffice">
		<explorer-tree:explorer-tree>
			<explorer-tree:navigation-node id="hmc_treenode_cloudinary">
				<explorer-tree:type-node code="CloudinaryConfig" id="hmc_typenode_cloudinaryconfig"/>
			</explorer-tree:navigation-node>
		</explorer-tree:explorer-tree>
	</context>

		<context type="CloudinaryConfig" parent="GenericItem" component="create-wizard" merge-by="type" >
			<wz:flow  id="ItemWizard" title="create.title(ctx.TYPE_CODE)">
				<wz:prepare id="itemPrepare">
					<wz:initialize property="newCloudinaryConfig" type="ctx.TYPE_CODE" />
				</wz:prepare>
				<wz:step id="step1" label="create.cloudinaryconfig.configuration">
					<wz:content id="step1.content">
						<wz:property-list root="newCloudinaryConfig">
							<wz:property qualifier="enableCloudinary" type="java.lang.Boolean" />
							<wz:property qualifier="cloudinaryURL" type="java.lang.String" />
							<wz:property qualifier="cloudinaryCname" type="java.lang.String" />
							<wz:property qualifier="cloudinaryGlobalImageTransformation" type="java.lang.String" />
							<wz:property qualifier="cloudinaryGlobalVideoTransformation" type="java.lang.String" />
							<wz:property qualifier="cloudinaryResponsive" type="java.lang.Boolean" />
							<wz:property qualifier="cloudinaryImageWidthLimitMax" type="java.lang.Integer" />
							<wz:property qualifier="cloudinaryImageWidthLimitMin" type="java.lang.Integer" />
							<wz:property qualifier="enableCloudinaryGalleryWidget" type="java.lang.Boolean" />
							<wz:property qualifier="cloudinaryByteStep" type="java.lang.Integer" />
							<wz:property qualifier="cloudinaryFolderPath" type="java.lang.String" />
							<wz:property qualifier="cloudinaryImageFormat" type="java.lang.String" />
							<wz:property qualifier="cloudinaryMaxBreakPoints" type="java.lang.Integer" />
							<wz:property qualifier="cloudinaryQuality" type="java.lang.String" />
						</wz:property-list>
					</wz:content>
					<wz:navigation id="step1.navigation">
						<wz:cancel/>
						<wz:done>
							<wz:save property="newCloudinaryConfig"/>
						</wz:done>
					</wz:navigation>
				</wz:step>
			</wz:flow>
		</context>

		<context component="editor-area" merge-mode="append" merge-by="type" type="CloudinaryConfig">
			<editorArea:editorArea>
				<editorArea:tab name="hmc.tab.cloudinaryconfig" merge-mode="append">
					<editorArea:section name="cloudinaryconfig.section.common.attributes">
						<editorArea:attribute qualifier="cloudinaryURL" />
						<editorArea:attribute qualifier="cloudinaryFolderPath"/>
						<editorArea:attribute qualifier="cloudinaryImageFormat"/>
						<editorArea:attribute qualifier="cloudinaryQuality"/>
						<editorArea:attribute qualifier="cloudinaryMaxBreakPoints"/>
						<editorArea:attribute qualifier="cloudinaryByteStep"/>
						<editorArea:attribute qualifier="cloudinaryImageWidthLimitMax"/>
						<editorArea:attribute qualifier="cloudinaryImageWidthLimitMin"/>
						<editorArea:attribute qualifier="cloudinaryGlobalImageTransformation"/>
						<editorArea:attribute qualifier="cloudinaryGlobalVideoTransformation"/>
						<editorArea:attribute qualifier="cloudinaryCname"/>
						<editorArea:attribute qualifier="cloudinaryResponsive"/>
						<editorArea:attribute qualifier="enableCloudinaryGalleryWidget"/>
					</editorArea:section>
					<editorArea:customSection name="hmc.section.cloudinary.connection" position="4"
									  spring-bean="cloudinaryConfigAdminUsageRenderer"/>
				</editorArea:tab>
			</editorArea:editorArea>
		</context>

	<context type="Media" component="create-wizard" merge-by="type" parent="auto" >
		<wz:flow id="MediaWizard" title="create.title(ctx.TYPE_CODE)">
			<wz:prepare id="mediaPrepare">
				<wz:initialize property="newMedia" type="ctx.TYPE_CODE"/>
				<wz:assign property="newMedia.catalogVersion" value="ctx.parentObject?.catalogVersion"/>
			</wz:prepare>
			<wz:step id="step1" label="essential.label" sublabel="essential.sublabel">
				<wz:content id="step1.content">
					<wz:property-list root="newMedia">
						<wz:property qualifier="code" position="10"/>
						<wz:property qualifier="catalogVersion" position="20"/>
						<wz:property qualifier="removable" position="30" exclude="true"/>
					</wz:property-list>
				</wz:content>
				<wz:navigation id="step1.navigation">
					<wz:cancel/>
					<wz:next visible="!#empty(newMedia.code) and newMedia.catalogVersion != null"/>
					<wz:done visible="!#empty(newMedia.code) and newMedia.catalogVersion != null">
						<wz:save property="newMedia"/>
					</wz:done>
				</wz:navigation>
			</wz:step>

			<wz:step id="step2" label="media.content.label" sublabel="media.content.sublabel">
				<wz:content id="step2.content">
					<wz:property qualifier="mediaContent" position="10"
								 type="com.hybris.cockpitng.editor.defaultfileupload.FileUploadResult" editor="com.hybris.cockpitng.editor.dndfileupload"/>
				</wz:content>
				<wz:navigation id="step2.navigation">
					<wz:cancel>
						<wz:revert property="newMedia"/>
					</wz:cancel>
					<wz:back/>
					<wz:next/>
					<wz:custom visible="!#empty(newMedia.code) and newMedia.catalogVersion != null" label="com.hybris.cockpitng.widgets.configurableflow.flow.done" handler="mediaContentUpdateHandler">
						<wz:parameter>
							<wz:name>mediaProperty</wz:name>
							<wz:value>newMedia</wz:value>
						</wz:parameter>
						<wz:parameter>
							<wz:name>mediaContentProperty</wz:name>
							<wz:value>mediaContent</wz:value>
						</wz:parameter>
					</wz:custom>
				</wz:navigation>
			</wz:step>

			<wz:step id="step4" label="media.content.label" sublabel="cloudinarymedia.content.sublabel" merge-mode="replace">
				<wz:content id="step4.content">
					<wz:custom-view lang="zul" src="widgets/cloudinaryuploadpreview.zul" />
				</wz:content>
				<wz:navigation id="step4.navigation">
					<wz:cancel>
						<wz:revert property="newMedia"/>
					</wz:cancel>
					<wz:back/>
					<wz:custom visible="!#empty(newMedia.code) and newMedia.catalogVersion != null" label="Done" handler="mediaContentUpdateHandler">
						<wz:parameter>
							<wz:name>mediaProperty</wz:name>
							<wz:value>newMedia</wz:value>
						</wz:parameter>
						<wz:parameter>
							<wz:name>media</wz:name>
							<wz:value>create</wz:value>
						</wz:parameter>
					</wz:custom>
				</wz:navigation>
			</wz:step>
			<wz:step id="step3" label="properties.label" sublabel="properties.sublabel" merge-mode="remove">
				<wz:content id="step3.content">
					<wz:property-list root="newMedia">
						<wz:property qualifier="folder" position="10"/>
						<wz:property qualifier="mediaFormat" position="20"/>
						<wz:property qualifier="mediaContainer" position="30"/>
					</wz:property-list>
				</wz:content>
				<wz:navigation id="step3.navigation">
					<wz:cancel/>
					<wz:back/>
					<wz:custom visible="!#empty(newMedia.code) and newMedia.catalogVersion != null" label="Done Upload" handler="mediaContentUpdateHandler">
						<wz:parameter>
							<wz:name>mediaProperty</wz:name>
							<wz:value>newMedia</wz:value>
						</wz:parameter>
						<wz:parameter>
							<wz:name>mediaContentProperty</wz:name>
							<wz:value>mediaContent1</wz:value>
						</wz:parameter>
					</wz:custom>
				</wz:navigation>
			</wz:step>
		</wz:flow>
	</context>

	<context merge-by="type" parent="auto" type="Media" component="editor-area">
	<editorArea:editorArea>
	<editorArea:tab name="hmc.tab.common" merge-mode="append">
		<editorArea:customSection name="hmc.section.media.content" spring-bean="cloudinaryMediaContentUpdateRenderer"/>
		<editorArea:section name="hmc.cloudinary.response.properties" merge-mode="replace">
		    <editorArea:attribute qualifier="cloudinaryURL" readonly="true"/>
			<editorArea:attribute qualifier="cloudinaryResourceType" readonly="true"/>
		    <editorArea:attribute qualifier="cloudinaryType" readonly="true"/>
		    <editorArea:attribute qualifier="cloudinaryPublicId" readonly="true"/>
			<editorArea:attribute qualifier="cloudinaryTransformation" readonly="true"/>
			<editorArea:attribute qualifier="isCloudinaryOverride" readonly="true"/>
			<editorArea:attribute qualifier="cloudinaryMediaFormat" readonly="true"/>
			<editorArea:attribute qualifier="cloudinaryVersion" readonly="true"/>
		</editorArea:section>
	</editorArea:tab>
	</editorArea:editorArea>
	</context>

	<context type="Media" component="editorareaactions" merge-by="type">
		<y:actions>
			<y:group qualifier="common" position="10">
				<y:label>actiongroup.common</y:label>
				<y:action action-id="uk.ptr.cloudinary.backoffice.widgets.actions.deletecloudinarymedia" property="currentObject" position="10"/>
				<y:action action-id="com.hybris.cockpitng.action.delete" property="currentObject" merge-mode="REMOVE" />
				<y:action action-id="com.hybris.backoffice.widgets.actions.sync" property="currentObject" position="20" />
			</y:group>
		</y:actions>
	</context>

	<context merge-by="type" type="MediaFormat" component="editor-area">
		<editorArea:editorArea name="hmc.tab.media.metadata">
			<editorArea:tab name="hmc.tab.mediafolder.conversion" >
				<editorArea:section name="hmc.tab.mediafolder.conversion">
					<editorArea:attribute qualifier="conversion"/>
				</editorArea:section>
			</editorArea:tab>
		</editorArea:editorArea>
	</context>

	<context merge-by="type" parent="GenericItem" type="ConversionGroup" component="editor-area">
		<editorArea:editorArea name="">
			<editorArea:essentials>
				<editorArea:essentialSection name="hmc.essential" merge-mode="append">
					<editorArea:attribute qualifier="code" />
				</editorArea:essentialSection>
			</editorArea:essentials>
			<editorArea:tab name="hmc.tab.mediacontainer.commons">
				<editorArea:section name="hmc.tab.mediacontainer.properties" merge-mode="replace">
					<editorArea:attribute qualifier="name"/>
					<editorArea:attribute qualifier="supportedMediaFormats"/>
				</editorArea:section>
			</editorArea:tab>
		</editorArea:editorArea>
	</context>

</config>
